"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var DBHelper=function(){function n(){_classCallCheck(this,n)}return _createClass(n,null,[{key:"openDatabase",value:function(){return navigator.serviceWorker?idb.open("restaurants",1,function(e){e.createObjectStore("restaurants",{keyPath:"id"})}):Promise.resolve()}},{key:"populateDatabase",value:function(r){return n.openDatabase().then(function(e){if(e){var t=e.transaction("restaurants","readwrite"),n=t.objectStore("restaurants");return r.forEach(function(e){n.put(e)}),t.complete}})}},{key:"getIdbRestaurants",value:function(){return n.openDatabase().then(function(e){if(e)return e.transaction("restaurants").objectStore("restaurants").getAll()})}},{key:"fetchRestaurants",value:function(t){return n.getIdbRestaurants().then(function(e){return e.length?e:fetch(n.DATABASE_URL).then(function(e){return e.json()}).then(function(e){return n.populateDatabase(e),e})}).then(function(e){t(null,e)})}},{key:"fetchRestaurantById",value:function(r,o){n.fetchRestaurants(function(e,t){if(e)o(e,null);else{var n=t.find(function(e){return e.id==r});n?o(null,n):o("Restaurant does not exist",null)}})}},{key:"fetchRestaurantByCuisine",value:function(r,o){n.fetchRestaurants(function(e,t){if(e)o(e,null);else{var n=t.filter(function(e){return e.cuisine_type==r});o(null,n)}})}},{key:"fetchRestaurantByNeighborhood",value:function(r,o){n.fetchRestaurants(function(e,t){if(e)o(e,null);else{var n=t.filter(function(e){return e.neighborhood==r});o(null,n)}})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(r,o,a){n.fetchRestaurants(function(e,t){if(e)a(e,null);else{var n=t;"all"!=r&&(n=n.filter(function(e){return e.cuisine_type==r})),"all"!=o&&(n=n.filter(function(e){return e.neighborhood==o})),a(null,n)}})}},{key:"fetchNeighborhoods",value:function(o){n.fetchRestaurants(function(e,n){if(e)o(e,null);else{var r=n.map(function(e,t){return n[t].neighborhood}),t=r.filter(function(e,t){return r.indexOf(e)==t});o(null,t)}})}},{key:"fetchCuisines",value:function(o){n.fetchRestaurants(function(e,n){if(e)o(e,null);else{var r=n.map(function(e,t){return n[t].cuisine_type}),t=r.filter(function(e,t){return r.indexOf(e)==t});o(null,t)}})}},{key:"urlForRestaurant",value:function(e){return"./restaurant.html?id="+e.id}},{key:"imageUrlForRestaurant",value:function(e,t){return 10==e.id&&(e.photograph=10),"dist/img/"+e.photograph+"-"+t+".webp"}},{key:"mapMarkerForRestaurant",value:function(e,t){return new google.maps.Marker({position:e.latlng,title:e.name,url:n.urlForRestaurant(e),map:t,animation:google.maps.Animation.DROP})}},{key:"DATABASE_URL",get:function(){return"http://localhost:1337/restaurants"}}]),n}();!function(e,t){"function"==typeof define&&define.amd?define(function(){return t(e)}):"object"==("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=t:e.echo=t(e)}(void 0,function(u){var c,e,a,i,s,l={},d=function(){},f=function(e,t){if(null===e.offsetParent)return!1;var n=e.getBoundingClientRect();return n.right>=t.l&&n.bottom>=t.t&&n.left<=t.r&&n.top<=t.b},p=function(){(i||!e)&&(clearTimeout(e),e=setTimeout(function(){l.render(),e=null},a))};return l.init=function(e){var t=(e=e||{}).offset||0,n=e.offsetVertical||t,r=e.offsetHorizontal||t,o=function(e,t){return parseInt(e||t,10)};c={t:o(e.offsetTop,n),b:o(e.offsetBottom,n),l:o(e.offsetLeft,r),r:o(e.offsetRight,r)},a=o(e.throttle,250),i=!1!==e.debounce,s=!!e.unload,d=e.callback||d,l.render(),document.addEventListener?(u.addEventListener("scroll",p,!1),u.addEventListener("load",p,!1)):(u.attachEvent("onscroll",p),u.attachEvent("onload",p))},l.render=function(e){for(var t,n,r=(e||document).querySelectorAll("[data-echo], [data-echo-background]"),o=r.length,a={l:0-c.l,t:0-c.t,b:(u.innerHeight||document.documentElement.clientHeight)+c.b,r:(u.innerWidth||document.documentElement.clientWidth)+c.r},i=0;i<o;i++)n=r[i],f(n,a)?(s&&n.setAttribute("data-echo-placeholder",n.src),null!==n.getAttribute("data-echo-background")?n.style.backgroundImage="url("+n.getAttribute("data-echo-background")+")":n.src!==(t=n.getAttribute("data-echo"))&&(n.src=t),s||(n.removeAttribute("data-echo"),n.removeAttribute("data-echo-background")),d(n,"load")):s&&(t=n.getAttribute("data-echo-placeholder"))&&(null!==n.getAttribute("data-echo-background")?n.style.backgroundImage="url("+t+")":n.src=t,n.removeAttribute("data-echo-placeholder"),d(n,"unload"));o||l.detach()},l.detach=function(){document.removeEventListener?u.removeEventListener("scroll",p):u.detachEvent("onscroll",p),clearTimeout(e)},l}),function(){function i(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function a(n,r,o){var a,e=new Promise(function(e,t){i(a=n[r].apply(n,o)).then(e,t)});return e.request=a,e}function e(e,n,t){t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this[n][t]},set:function(e){this[n][t]=e}})})}function t(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return a(this[n],e,arguments)})})}function n(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return this[n][e].apply(this[n],arguments)})})}function r(e,r,t,n){n.forEach(function(n){n in t.prototype&&(e.prototype[n]=function(){return e=this[r],(t=a(e,n,arguments)).then(function(e){if(e)return new u(e,t.request)});var e,t})})}function o(e){this._index=e}function u(e,t){this._cursor=e,this._request=t}function c(e){this._store=e}function s(n){this._tx=n,this.complete=new Promise(function(e,t){n.oncomplete=function(){e()},n.onerror=function(){t(n.error)},n.onabort=function(){t(n.error)}})}function l(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new s(n)}function d(e){this._db=e}e(o,"_index",["name","keyPath","multiEntry","unique"]),t(o,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),r(o,"_index",IDBIndex,["openCursor","openKeyCursor"]),e(u,"_cursor",["direction","key","primaryKey","value"]),t(u,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(u.prototype[n]=function(){var t=this,e=arguments;return Promise.resolve().then(function(){return t._cursor[n].apply(t._cursor,e),i(t._request).then(function(e){if(e)return new u(e,t._request)})})})}),c.prototype.createIndex=function(){return new o(this._store.createIndex.apply(this._store,arguments))},c.prototype.index=function(){return new o(this._store.index.apply(this._store,arguments))},e(c,"_store",["name","keyPath","indexNames","autoIncrement"]),t(c,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),r(c,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),n(c,"_store",IDBObjectStore,["deleteIndex"]),s.prototype.objectStore=function(){return new c(this._tx.objectStore.apply(this._tx,arguments))},e(s,"_tx",["objectStoreNames","mode"]),n(s,"_tx",IDBTransaction,["abort"]),l.prototype.createObjectStore=function(){return new c(this._db.createObjectStore.apply(this._db,arguments))},e(l,"_db",["name","version","objectStoreNames"]),n(l,"_db",IDBDatabase,["deleteObjectStore","close"]),d.prototype.transaction=function(){return new s(this._db.transaction.apply(this._db,arguments))},e(d,"_db",["name","version","objectStoreNames"]),n(d,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(a){[c,o].forEach(function(e){e.prototype[a.replace("open","iterate")]=function(){var e,t=(e=arguments,Array.prototype.slice.call(e)),n=t[t.length-1],r=this._store||this._index,o=r[a].apply(r,t.slice(0,-1));o.onsuccess=function(){n(o.result)}}})}),[o,c].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,n){var r=this,o=[];return new Promise(function(t){r.iterateCursor(e,function(e){e?(o.push(e.value),void 0===n||o.length!=n?e.continue():t(o)):t(o)})})})});var f={open:function(e,t,n){var r=a(indexedDB,"open",[e,t]),o=r.request;return o.onupgradeneeded=function(e){n&&n(new l(o.result,e.oldVersion,o.transaction))},r.then(function(e){return new d(e)})},delete:function(e){return a(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?(module.exports=f,module.exports.default=module.exports):self.idb=f}();var images=document.querySelectorAll(".lazy"),config={rootMargin:"50px 0px",threshold:.01},observer=new IntersectionObserver(onIntersection,config);function onIntersection(e){e.forEach(function(e){0<e.intersectionRatio&&(observer.unobserve(e.target),preloadImage(e.target))})}images.forEach(function(e){observer.observe(e)});var restaurants=void 0,neighborhoods=void 0,cuisines=void 0,markers=[];document.addEventListener("DOMContentLoaded",function(e){fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=function(){DBHelper.fetchNeighborhoods(function(e,t){e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.neighborhoods,n=document.getElementById("neighborhoods-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})},fetchCuisines=function(){DBHelper.fetchCuisines(function(e,t){e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})},fillCuisinesHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.cuisines,n=document.getElementById("cuisines-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})},window.initMap=function(){self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),updateRestaurants()},updateRestaurants=function(){var e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,r=t.selectedIndex,o=e[n].value,a=t[r].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(o,a,function(e,t){e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})},resetRestaurants=function(e){self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(function(e){return e.setMap(null)}),self.markers=[],self.restaurants=e},fillRestaurantsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants,t=document.getElementById("restaurants-list");e.forEach(function(e){t.append(createRestaurantHTML(e))}),addMarkersToMap()},createRestaurantHTML=function(e){var t=document.createElement("li"),n="small";window.matchMedia("screen and (min-width: 1000px)")?n="medium":window.matchMedia("screen and (min-width: 600px)")&&(n="small");var r=document.createElement("img");r.className="restaurant-img lazy",r.setAttribute("data-src",DBHelper.imageUrlForRestaurant(e,n)),r.alt=e.name+" resturant picture",10==e.id&&r.setAttribute("onload","lazyLoad()"),t.append(r);var o=document.createElement("h2");o.innerHTML=e.name,o.tabIndex=0,t.append(o);var a=document.createElement("p");a.innerHTML=e.neighborhood,a.tabIndex=0,t.append(a);var i=document.createElement("p");i.innerHTML=e.address,i.tabIndex=0,t.append(i);var u=document.createElement("a");return u.innerHTML="View Details",u.href=DBHelper.urlForRestaurant(e),t.append(u),t},addMarkersToMap=function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants).forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",function(){window.location.href=t.url}),self.markers.push(t)})};var map,restaurant=void 0;window.initMap=function(){fetchRestaurantFromURL(function(e,t){e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})},fetchRestaurantFromURL=function(n){if(self.restaurant)n(null,self.restaurant);else{var e=getParameterByName("id");e?DBHelper.fetchRestaurantById(e,function(e,t){(self.restaurant=t)?(fillRestaurantHTML(),n(null,t)):console.error(e)}):(error="No restaurant id in URL",n(error,null))}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("restaurant-name");t.innerHTML=e.name,t.tabIndex=0;var n=document.getElementById("restaurant-address");n.innerHTML=e.address,n.tabIndex=0;var r="small",o=document.getElementById("restaurant-img");window.matchMedia("screen and (min-width: 1000px)")?r="medium":window.matchMedia("screen and (min-width: 600px)")&&(r="small"),o.className="restaurant-img lazy",o.setAttribute("data-src",DBHelper.imageUrlForRestaurant(e,r)),o.alt=e.name+" resturant picture";var a=document.getElementById("restaurant-cuisine");a.innerHTML=e.cuisine_type,a.tabIndex=0,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var n in e){var r=document.createElement("tr");r.tabIndex=0;var o=document.createElement("td");o.innerHTML=n,r.appendChild(o);var a=document.createElement("td");a.innerHTML=e[n],r.appendChild(a),t.appendChild(r)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),n=document.createElement("h3");if(n.innerHTML="Reviews",n.tabIndex=0,t.appendChild(n),!e){var r=document.createElement("p");return r.innerHTML="No reviews yet!",void t.appendChild(r)}var o=document.getElementById("reviews-list");e.forEach(function(e){o.appendChild(createReviewHTML(e))}),t.appendChild(o)},createReviewHTML=function(e){var t=document.createElement("li"),n=document.createElement("p");n.innerHTML=e.name,n.tabIndex=0,t.appendChild(n);var r=document.createElement("p");r.innerHTML=e.date,r.tabIndex=0,t.appendChild(r);var o=document.createElement("p");o.innerHTML="Rating: "+e.rating,o.tabIndex=0,t.appendChild(o);var a=document.createElement("p");return a.innerHTML=e.comments,a.tabIndex=0,t.appendChild(a),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRiaGVscGVyLmpzIiwiZWNoby5taW4uanMiLCJpZGIuanMiLCJpbnRlcnNlY3Rpb24tb2JzZXJ2ZXIuanMiLCJtYWluLmpzIiwicmVzdGF1cmFudF9pbmZvLmpzIl0sIm5hbWVzIjpbIkRCSGVscGVyIiwibmF2aWdhdG9yIiwic2VydmljZVdvcmtlciIsImlkYiIsIm9wZW4iLCJ1cGdyYWRlRGIiLCJjcmVhdGVPYmplY3RTdG9yZSIsImtleVBhdGgiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlc3RhdXJhbnRzIiwib3BlbkRhdGFiYXNlIiwidGhlbiIsImRiIiwidHgiLCJ0cmFuc2FjdGlvbiIsInN0b3JlIiwib2JqZWN0U3RvcmUiLCJmb3JFYWNoIiwicmVzdGF1cmFudCIsInB1dCIsImNvbXBsZXRlIiwiZ2V0QWxsIiwiY2FsbGJhY2siLCJnZXRJZGJSZXN0YXVyYW50cyIsImxlbmd0aCIsImZldGNoIiwiREFUQUJBU0VfVVJMIiwicmVzcG9uc2UiLCJqc29uIiwicG9wdWxhdGVEYXRhYmFzZSIsImlkIiwiZmV0Y2hSZXN0YXVyYW50cyIsImVycm9yIiwiZmluZCIsInIiLCJjdWlzaW5lIiwicmVzdWx0cyIsImZpbHRlciIsImN1aXNpbmVfdHlwZSIsIm5laWdoYm9yaG9vZCIsIm5laWdoYm9yaG9vZHMiLCJtYXAiLCJ2IiwiaSIsInVuaXF1ZU5laWdoYm9yaG9vZHMiLCJpbmRleE9mIiwiY3Vpc2luZXMiLCJ1bmlxdWVDdWlzaW5lcyIsInNpemUiLCJwaG90b2dyYXBoIiwiZ29vZ2xlIiwibWFwcyIsIk1hcmtlciIsInBvc2l0aW9uIiwibGF0bG5nIiwidGl0bGUiLCJuYW1lIiwidXJsIiwidXJsRm9yUmVzdGF1cmFudCIsImFuaW1hdGlvbiIsIkFuaW1hdGlvbiIsIkRST1AiLCJ0IiwiZSIsImRlZmluZSIsImFtZCIsImV4cG9ydHMiLCJfdHlwZW9mIiwibW9kdWxlIiwiZWNobyIsInVuZGVmaW5lZCIsIm4iLCJvIiwiYyIsImEiLCJ1IiwibCIsIm9mZnNldFBhcmVudCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInJpZ2h0IiwiYm90dG9tIiwibGVmdCIsInRvcCIsImIiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwicmVuZGVyIiwiaW5pdCIsImQiLCJvZmZzZXQiLCJvZmZzZXRWZXJ0aWNhbCIsImYiLCJvZmZzZXRIb3Jpem9udGFsIiwicyIsInBhcnNlSW50Iiwib2Zmc2V0VG9wIiwib2Zmc2V0Qm90dG9tIiwib2Zmc2V0TGVmdCIsIm9mZnNldFJpZ2h0IiwidGhyb3R0bGUiLCJkZWJvdW5jZSIsInVubG9hZCIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImF0dGFjaEV2ZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImlubmVySGVpZ2h0IiwiZG9jdW1lbnRFbGVtZW50IiwiY2xpZW50SGVpZ2h0IiwiaW5uZXJXaWR0aCIsImNsaWVudFdpZHRoIiwic2V0QXR0cmlidXRlIiwic3JjIiwiZ2V0QXR0cmlidXRlIiwic3R5bGUiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJyZW1vdmVBdHRyaWJ1dGUiLCJkZXRhY2giLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZGV0YWNoRXZlbnQiLCJwcm9taXNpZnlSZXF1ZXN0IiwicmVxdWVzdCIsInJlamVjdCIsIm9uc3VjY2VzcyIsInJlc3VsdCIsIm9uZXJyb3IiLCJwcm9taXNpZnlSZXF1ZXN0Q2FsbCIsIm9iaiIsIm1ldGhvZCIsImFyZ3MiLCJwIiwiYXBwbHkiLCJwcm94eVByb3BlcnRpZXMiLCJQcm94eUNsYXNzIiwidGFyZ2V0UHJvcCIsInByb3BlcnRpZXMiLCJwcm9wIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJwcm90b3R5cGUiLCJnZXQiLCJ0aGlzIiwic2V0IiwidmFsIiwicHJveHlSZXF1ZXN0TWV0aG9kcyIsIkNvbnN0cnVjdG9yIiwiYXJndW1lbnRzIiwicHJveHlNZXRob2RzIiwicHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyIsInZhbHVlIiwiQ3Vyc29yIiwiSW5kZXgiLCJpbmRleCIsIl9pbmRleCIsImN1cnNvciIsIl9jdXJzb3IiLCJfcmVxdWVzdCIsIk9iamVjdFN0b3JlIiwiX3N0b3JlIiwiVHJhbnNhY3Rpb24iLCJpZGJUcmFuc2FjdGlvbiIsIl90eCIsIm9uY29tcGxldGUiLCJvbmFib3J0IiwiVXBncmFkZURCIiwib2xkVmVyc2lvbiIsIl9kYiIsIkRCIiwiSURCSW5kZXgiLCJJREJDdXJzb3IiLCJtZXRob2ROYW1lIiwiY3JlYXRlSW5kZXgiLCJJREJPYmplY3RTdG9yZSIsIklEQlRyYW5zYWN0aW9uIiwiSURCRGF0YWJhc2UiLCJmdW5jTmFtZSIsInJlcGxhY2UiLCJhcnIiLCJBcnJheSIsInNsaWNlIiwiY2FsbCIsIm5hdGl2ZU9iamVjdCIsInF1ZXJ5IiwiY291bnQiLCJpbnN0YW5jZSIsIml0ZW1zIiwiaXRlcmF0ZUN1cnNvciIsInB1c2giLCJjb250aW51ZSIsImV4cCIsInZlcnNpb24iLCJ1cGdyYWRlQ2FsbGJhY2siLCJpbmRleGVkREIiLCJvbnVwZ3JhZGVuZWVkZWQiLCJldmVudCIsImRlbGV0ZSIsImRlZmF1bHQiLCJzZWxmIiwiaW1hZ2VzIiwiY29uZmlnIiwicm9vdE1hcmdpbiIsInRocmVzaG9sZCIsIm9ic2VydmVyIiwiSW50ZXJzZWN0aW9uT2JzZXJ2ZXIiLCJvbkludGVyc2VjdGlvbiIsImVudHJpZXMiLCJlbnRyeSIsImludGVyc2VjdGlvblJhdGlvIiwidW5vYnNlcnZlIiwidGFyZ2V0IiwicHJlbG9hZEltYWdlIiwiaW1hZ2UiLCJvYnNlcnZlIiwibWFya2VycyIsImZldGNoTmVpZ2hib3Job29kcyIsImZldGNoQ3Vpc2luZXMiLCJjb25zb2xlIiwiZmlsbE5laWdoYm9yaG9vZHNIVE1MIiwic2VsZWN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJvcHRpb24iLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwiYXBwZW5kIiwiZmlsbEN1aXNpbmVzSFRNTCIsIndpbmRvdyIsImluaXRNYXAiLCJNYXAiLCJ6b29tIiwiY2VudGVyIiwibGF0IiwibG5nIiwic2Nyb2xsd2hlZWwiLCJ1cGRhdGVSZXN0YXVyYW50cyIsImNTZWxlY3QiLCJuU2VsZWN0IiwiY0luZGV4Iiwic2VsZWN0ZWRJbmRleCIsIm5JbmRleCIsImZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZCIsInJlc2V0UmVzdGF1cmFudHMiLCJmaWxsUmVzdGF1cmFudHNIVE1MIiwibSIsInNldE1hcCIsInVsIiwiY3JlYXRlUmVzdGF1cmFudEhUTUwiLCJhZGRNYXJrZXJzVG9NYXAiLCJsaSIsIm1hdGNoTWVkaWEiLCJjbGFzc05hbWUiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJhbHQiLCJ0YWJJbmRleCIsImFkZHJlc3MiLCJtb3JlIiwiaHJlZiIsIm1hcmtlciIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJhZGRMaXN0ZW5lciIsImxvY2F0aW9uIiwiZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCIsImZpbGxCcmVhZGNydW1iIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwiZmV0Y2hSZXN0YXVyYW50QnlJZCIsImZpbGxSZXN0YXVyYW50SFRNTCIsIm9wZXJhdGluZ19ob3VycyIsImZpbGxSZXN0YXVyYW50SG91cnNIVE1MIiwiZmlsbFJldmlld3NIVE1MIiwib3BlcmF0aW5nSG91cnMiLCJob3VycyIsImtleSIsInJvdyIsImRheSIsImFwcGVuZENoaWxkIiwidGltZSIsInJldmlld3MiLCJjb250YWluZXIiLCJub1Jldmlld3MiLCJyZXZpZXciLCJjcmVhdGVSZXZpZXdIVE1MIiwiZGF0ZSIsInJhdGluZyIsImNvbW1lbnRzIiwiYnJlYWRjcnVtYiIsIlJlZ0V4cCIsImV4ZWMiLCJkZWNvZGVVUklDb21wb25lbnQiXSwibWFwcGluZ3MiOiJtbEJBS0FBLDBIQWlCQSxPQUFBQyxVQUFBQyxjQUlBQyxJQUFBQyxLQUFBLGNBQUEsRUFBQSxTQUFBQyxHQUNBQSxFQUFBQyxrQkFBQSxjQUFBLENBQ0FDLFFBQUEsU0FMQUMsUUFBQUMsbURBVUFDLEdBQ0EsT0FBQVYsRUFB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LEtBS0EsT0FKQTZELEVBQUE1RCxVQUFBd0QsRUFBQUksU0FDQUEsRUFBQTlCLFNBQUEsRUFDQUwsRUFBQTBCLFlBQUFTLEdBRUFuQyxHQU1BYyxlQUFBLFdBQUEsSUFBQW5QLEVBQUEsRUFBQWdJLFVBQUExSCxhQUFBOEMsSUFBQTRFLFVBQUEsR0FBQUEsVUFBQSxHQUFBbUQsS0FBQW5MLFdBQ0F5USxFQUFBckwsU0FBQXFILGVBQUEsY0FDQTRCLEVBQUFqSixTQUFBdUgsY0FBQSxNQUNBMEIsRUFBQXpCLFVBQUE1TSxFQUFBc0MsS0FDQW1PLEVBQUFWLFlBQUExQixJQU1BZSxtQkFBQSxTQUFBOU0sRUFBQUMsR0FDQUEsSUFDQUEsRUFBQXdLLE9BQUFrQyxTQUFBSixNQUNBdk0sRUFBQUEsRUFBQXdILFFBQUEsVUFBQSxRQUNBLElBQ0E1SSxFQURBLElBQUF3UCxPQUFBLE9BQUFwTyxFQUFBLHFCQUNBcU8sS0FBQXBPLEdBQ0EsT0FBQXJCLEVBRUFBLEVBQUEsR0FFQTBQLG1CQUFBMVAsRUFBQSxHQUFBNEksUUFBQSxNQUFBLE1BREEsR0FGQSIsImZpbGUiOiJidW5kbGUtbWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENvbW1vbiBkYXRhYmFzZSBoZWxwZXIgZnVuY3Rpb25zLlxyXG4gKi9cclxuXHJcblxyXG5jbGFzcyBEQkhlbHBlciB7XHJcblxyXG4gIC8qKlxyXG4gICAqIERhdGFiYXNlIFVSTC5cclxuICAgKiBDaGFuZ2UgdGhpcyB0byByZXN0YXVyYW50cy5qc29uIGZpbGUgbG9jYXRpb24gb24geW91ciBzZXJ2ZXIuXHJcbiAgICovXHJcblxyXG4gIC8qc3RhdGljIGdldCBEQVRBQkFTRV9VUkwoKSB7XHJcbiAgICBjb25zdCBwb3J0ID0gODA4MCAvLyBDaGFuZ2UgdGhpcyB0byB5b3VyIHNlcnZlciBwb3J0XHJcbiAgICByZXR1cm4gYGh0dHA6Ly9sb2NhbGhvc3Q6JHtwb3J0fS9kYXRhL3Jlc3RhdXJhbnRzLmpzb25gO1xyXG4gIH0qL1xyXG4gIHN0YXRpYyBnZXQgREFUQUJBU0VfVVJMKCkge1xyXG4gICAgY29uc3QgcG9ydCA9IDEzMzcgLy8gQ2hhbmdlIHRoaXMgdG8geW91ciBzZXJ2ZXIgcG9ydFxyXG4gICAgcmV0dXJuIGBodHRwOi8vbG9jYWxob3N0OiR7cG9ydH0vcmVzdGF1cmFudHNgO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIG9wZW5EYXRhYmFzZSgpIHtcclxuICAgIGlmKCFuYXZpZ2F0b3Iuc2VydmljZVdvcmtlcil7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gaWRiLm9wZW4oJ3Jlc3RhdXJhbnRzJywgMSwgZnVuY3Rpb24gKHVwZ3JhZGVEYikge1xyXG4gICAgICB2YXIgc3RvcmUgPSB1cGdyYWRlRGIuY3JlYXRlT2JqZWN0U3RvcmUoJ3Jlc3RhdXJhbnRzJywge1xyXG4gICAgICAgIGtleVBhdGg6ICdpZCdcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBwb3B1bGF0ZURhdGFiYXNlKHJlc3RhdXJhbnRzKXtcclxuICAgIHJldHVybiBEQkhlbHBlci5vcGVuRGF0YWJhc2UoKS50aGVuKGZ1bmN0aW9uKGRiKXtcclxuICAgICAgaWYoIWRiKSByZXR1cm47XHJcblxyXG4gICAgICB2YXIgdHggPSBkYi50cmFuc2FjdGlvbigncmVzdGF1cmFudHMnLCAncmVhZHdyaXRlJyk7XHJcbiAgICAgIHZhciBzdG9yZSA9IHR4Lm9iamVjdFN0b3JlKCdyZXN0YXVyYW50cycpO1xyXG4gICAgICByZXN0YXVyYW50cy5mb3JFYWNoKGZ1bmN0aW9uIChyZXN0YXVyYW50KSB7XHJcbiAgICAgICAgICBzdG9yZS5wdXQocmVzdGF1cmFudCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIHJldHVybiB0eC5jb21wbGV0ZTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIGdldElkYlJlc3RhdXJhbnRzKCl7XHJcbiAgICByZXR1cm4gREJIZWxwZXIub3BlbkRhdGFiYXNlKCkudGhlbihmdW5jdGlvbihkYil7XHJcbiAgICAgIGlmKCFkYikgcmV0dXJuO1xyXG5cclxuICAgICAgdmFyIHR4ID0gZGIudHJhbnNhY3Rpb24oJ3Jlc3RhdXJhbnRzJyk7XHJcbiAgICAgIHZhciBzdG9yZSA9IHR4Lm9iamVjdFN0b3JlKCdyZXN0YXVyYW50cycpO1xyXG4gICAgICByZXR1cm4gc3RvcmUuZ2V0QWxsKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGFsbCByZXN0YXVyYW50cy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50cyhjYWxsYmFjaykge1xyXG4gICAgLypsZXQgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICB4aHIub3BlbignR0VUJywgREJIZWxwZXIuREFUQUJBU0VfVVJMKTtcclxuICAgIHhoci5vbmxvYWQgPSAoKSA9PiB7XHJcbiAgICAgIGlmICh4aHIuc3RhdHVzID09PSAyMDApIHsgLy8gR290IGEgc3VjY2VzcyByZXNwb25zZSBmcm9tIHNlcnZlciFcclxuICAgICAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZSh4aHIucmVzcG9uc2VUZXh0KTtcclxuICAgICAgICBjb25zdCByZXN0YXVyYW50cyA9IGpzb24ucmVzdGF1cmFudHM7XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudHMpO1xyXG4gICAgICB9IGVsc2UgeyAvLyBPb3BzIS4gR290IGFuIGVycm9yIGZyb20gc2VydmVyLlxyXG4gICAgICAgIGNvbnN0IGVycm9yID0gKGBSZXF1ZXN0IGZhaWxlZC4gUmV0dXJuZWQgc3RhdHVzIG9mICR7eGhyLnN0YXR1c31gKTtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICB4aHIuc2VuZCgpOyovXHJcbiAgICByZXR1cm4gREJIZWxwZXIuZ2V0SWRiUmVzdGF1cmFudHMoKS50aGVuKChyZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAocmVzdGF1cmFudHMubGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlc3RhdXJhbnRzO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChEQkhlbHBlci5EQVRBQkFTRV9VUkwpXHJcbiAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgfSkudGhlbihyZXN0YXVyYW50cyA9PiB7XHJcbiAgICAgICAgICAgIERCSGVscGVyLnBvcHVsYXRlRGF0YWJhc2UocmVzdGF1cmFudHMpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdGF1cmFudHM7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pLnRoZW4ocmVzdGF1cmFudHMgPT4ge1xyXG4gICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50cylcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYSByZXN0YXVyYW50IGJ5IGl0cyBJRC5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgY2FsbGJhY2spIHtcclxuICAgIC8vIGZldGNoIGFsbCByZXN0YXVyYW50cyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc3QgcmVzdGF1cmFudCA9IHJlc3RhdXJhbnRzLmZpbmQociA9PiByLmlkID09IGlkKTtcclxuICAgICAgICBpZiAocmVzdGF1cmFudCkgeyAvLyBHb3QgdGhlIHJlc3RhdXJhbnRcclxuICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpO1xyXG4gICAgICAgIH0gZWxzZSB7IC8vIFJlc3RhdXJhbnQgZG9lcyBub3QgZXhpc3QgaW4gdGhlIGRhdGFiYXNlXHJcbiAgICAgICAgICBjYWxsYmFjaygnUmVzdGF1cmFudCBkb2VzIG5vdCBleGlzdCcsIG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgdHlwZSB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lKGN1aXNpbmUsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHMgIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEZpbHRlciByZXN0YXVyYW50cyB0byBoYXZlIG9ubHkgZ2l2ZW4gY3Vpc2luZSB0eXBlXHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpO1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeU5laWdoYm9yaG9vZChuZWlnaGJvcmhvb2QsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBuZWlnaGJvcmhvb2RcclxuICAgICAgICBjb25zdCByZXN1bHRzID0gcmVzdGF1cmFudHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgYW5kIGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kLCBjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxldCByZXN1bHRzID0gcmVzdGF1cmFudHNcclxuICAgICAgICBpZiAoY3Vpc2luZSAhPSAnYWxsJykgeyAvLyBmaWx0ZXIgYnkgY3Vpc2luZVxyXG4gICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5jdWlzaW5lX3R5cGUgPT0gY3Vpc2luZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChuZWlnaGJvcmhvb2QgIT0gJ2FsbCcpIHsgLy8gZmlsdGVyIGJ5IG5laWdoYm9yaG9vZFxyXG4gICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoTmVpZ2hib3Job29kcyhjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEdldCBhbGwgbmVpZ2hib3Job29kcyBmcm9tIGFsbCByZXN0YXVyYW50c1xyXG4gICAgICAgIGNvbnN0IG5laWdoYm9yaG9vZHMgPSByZXN0YXVyYW50cy5tYXAoKHYsIGkpID0+IHJlc3RhdXJhbnRzW2ldLm5laWdoYm9yaG9vZClcclxuICAgICAgICAvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIG5laWdoYm9yaG9vZHNcclxuICAgICAgICBjb25zdCB1bmlxdWVOZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcy5maWx0ZXIoKHYsIGkpID0+IG5laWdoYm9yaG9vZHMuaW5kZXhPZih2KSA9PSBpKVxyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHVuaXF1ZU5laWdoYm9yaG9vZHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGFsbCBjdWlzaW5lcyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hDdWlzaW5lcyhjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEdldCBhbGwgY3Vpc2luZXMgZnJvbSBhbGwgcmVzdGF1cmFudHNcclxuICAgICAgICBjb25zdCBjdWlzaW5lcyA9IHJlc3RhdXJhbnRzLm1hcCgodiwgaSkgPT4gcmVzdGF1cmFudHNbaV0uY3Vpc2luZV90eXBlKVxyXG4gICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gY3Vpc2luZXNcclxuICAgICAgICBjb25zdCB1bmlxdWVDdWlzaW5lcyA9IGN1aXNpbmVzLmZpbHRlcigodiwgaSkgPT4gY3Vpc2luZXMuaW5kZXhPZih2KSA9PSBpKVxyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHVuaXF1ZUN1aXNpbmVzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXN0YXVyYW50IHBhZ2UgVVJMLlxyXG4gICAqL1xyXG4gIHN0YXRpYyB1cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcclxuICAgIHJldHVybiAoYC4vcmVzdGF1cmFudC5odG1sP2lkPSR7cmVzdGF1cmFudC5pZH1gKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc3RhdXJhbnQgaW1hZ2UgVVJMLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBpbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2l6ZSkge1xyXG4gICAgaWYocmVzdGF1cmFudC5pZCA9PSAxMCkgcmVzdGF1cmFudC5waG90b2dyYXBoID0gMTA7IFxyXG4gICAgcmV0dXJuIChgZGlzdC9pbWcvJHtyZXN0YXVyYW50LnBob3RvZ3JhcGh9LSR7c2l6ZX0ud2VicGApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTWFwIG1hcmtlciBmb3IgYSByZXN0YXVyYW50LlxyXG4gICAqL1xyXG4gIHN0YXRpYyBtYXBNYXJrZXJGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIG1hcCkge1xyXG4gICAgY29uc3QgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XHJcbiAgICAgIHBvc2l0aW9uOiByZXN0YXVyYW50LmxhdGxuZyxcclxuICAgICAgdGl0bGU6IHJlc3RhdXJhbnQubmFtZSxcclxuICAgICAgdXJsOiBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpLFxyXG4gICAgICBtYXA6IG1hcCxcclxuICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUH1cclxuICAgICk7XHJcbiAgICByZXR1cm4gbWFya2VyO1xyXG4gIH1cclxuXHJcbn1cclxuIiwiLyohIGVjaG8tanMgdjEuNy4zIHwgKGMpIDIwMTYgQHRvZGRtb3R0byB8IGh0dHBzOi8vZ2l0aHViLmNvbS90b2RkbW90dG8vZWNobyAqL1xuIWZ1bmN0aW9uKHQsZSl7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShmdW5jdGlvbigpe3JldHVybiBlKHQpfSk6XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZTp0LmVjaG89ZSh0KX0odGhpcyxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZSxuLG8scixjLGE9e30sdT1mdW5jdGlvbigpe30sZD1mdW5jdGlvbih0KXtyZXR1cm4gbnVsbD09PXQub2Zmc2V0UGFyZW50fSxsPWZ1bmN0aW9uKHQsZSl7aWYoZCh0KSlyZXR1cm4hMTt2YXIgbj10LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3JldHVybiBuLnJpZ2h0Pj1lLmwmJm4uYm90dG9tPj1lLnQmJm4ubGVmdDw9ZS5yJiZuLnRvcDw9ZS5ifSxpPWZ1bmN0aW9uKCl7KHJ8fCFuKSYmKGNsZWFyVGltZW91dChuKSxuPXNldFRpbWVvdXQoZnVuY3Rpb24oKXthLnJlbmRlcigpLG49bnVsbH0sbykpfTtyZXR1cm4gYS5pbml0PWZ1bmN0aW9uKG4pe249bnx8e307dmFyIGQ9bi5vZmZzZXR8fDAsbD1uLm9mZnNldFZlcnRpY2FsfHxkLGY9bi5vZmZzZXRIb3Jpem9udGFsfHxkLHM9ZnVuY3Rpb24odCxlKXtyZXR1cm4gcGFyc2VJbnQodHx8ZSwxMCl9O2U9e3Q6cyhuLm9mZnNldFRvcCxsKSxiOnMobi5vZmZzZXRCb3R0b20sbCksbDpzKG4ub2Zmc2V0TGVmdCxmKSxyOnMobi5vZmZzZXRSaWdodCxmKX0sbz1zKG4udGhyb3R0bGUsMjUwKSxyPW4uZGVib3VuY2UhPT0hMSxjPSEhbi51bmxvYWQsdT1uLmNhbGxiYWNrfHx1LGEucmVuZGVyKCksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcj8odC5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsaSwhMSksdC5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLGksITEpKToodC5hdHRhY2hFdmVudChcIm9uc2Nyb2xsXCIsaSksdC5hdHRhY2hFdmVudChcIm9ubG9hZFwiLGkpKX0sYS5yZW5kZXI9ZnVuY3Rpb24obil7Zm9yKHZhciBvLHIsZD0obnx8ZG9jdW1lbnQpLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS1lY2hvXSwgW2RhdGEtZWNoby1iYWNrZ3JvdW5kXVwiKSxpPWQubGVuZ3RoLGY9e2w6MC1lLmwsdDowLWUudCxiOih0LmlubmVySGVpZ2h0fHxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KStlLmIscjoodC5pbm5lcldpZHRofHxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgpK2Uucn0scz0wO2k+cztzKyspcj1kW3NdLGwocixmKT8oYyYmci5zZXRBdHRyaWJ1dGUoXCJkYXRhLWVjaG8tcGxhY2Vob2xkZXJcIixyLnNyYyksbnVsbCE9PXIuZ2V0QXR0cmlidXRlKFwiZGF0YS1lY2hvLWJhY2tncm91bmRcIik/ci5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2U9XCJ1cmwoXCIrci5nZXRBdHRyaWJ1dGUoXCJkYXRhLWVjaG8tYmFja2dyb3VuZFwiKStcIilcIjpyLnNyYyE9PShvPXIuZ2V0QXR0cmlidXRlKFwiZGF0YS1lY2hvXCIpKSYmKHIuc3JjPW8pLGN8fChyLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtZWNob1wiKSxyLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtZWNoby1iYWNrZ3JvdW5kXCIpKSx1KHIsXCJsb2FkXCIpKTpjJiYobz1yLmdldEF0dHJpYnV0ZShcImRhdGEtZWNoby1wbGFjZWhvbGRlclwiKSkmJihudWxsIT09ci5nZXRBdHRyaWJ1dGUoXCJkYXRhLWVjaG8tYmFja2dyb3VuZFwiKT9yLnN0eWxlLmJhY2tncm91bmRJbWFnZT1cInVybChcIitvK1wiKVwiOnIuc3JjPW8sci5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLWVjaG8tcGxhY2Vob2xkZXJcIiksdShyLFwidW5sb2FkXCIpKTtpfHxhLmRldGFjaCgpfSxhLmRldGFjaD1mdW5jdGlvbigpe2RvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXI/dC5yZW1vdmVFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsaSk6dC5kZXRhY2hFdmVudChcIm9uc2Nyb2xsXCIsaSksY2xlYXJUaW1lb3V0KG4pfSxhfSk7XG4iLCIndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbigpIHtcbiAgZnVuY3Rpb24gdG9BcnJheShhcnIpIHtcbiAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb21pc2lmeVJlcXVlc3QocmVxdWVzdCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlc29sdmUocmVxdWVzdC5yZXN1bHQpO1xuICAgICAgfTtcblxuICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChyZXF1ZXN0LmVycm9yKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncykge1xuICAgIHZhciByZXF1ZXN0O1xuICAgIHZhciBwID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICByZXF1ZXN0ID0gb2JqW21ldGhvZF0uYXBwbHkob2JqLCBhcmdzKTtcbiAgICAgIHByb21pc2lmeVJlcXVlc3QocmVxdWVzdCkudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgIH0pO1xuXG4gICAgcC5yZXF1ZXN0ID0gcmVxdWVzdDtcbiAgICByZXR1cm4gcDtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb21pc2lmeUN1cnNvclJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XG4gICAgdmFyIHAgPSBwcm9taXNpZnlSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncyk7XG4gICAgcmV0dXJuIHAudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgaWYgKCF2YWx1ZSkgcmV0dXJuO1xuICAgICAgcmV0dXJuIG5ldyBDdXJzb3IodmFsdWUsIHAucmVxdWVzdCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eVByb3BlcnRpZXMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgcHJvcGVydGllcykge1xuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUHJveHlDbGFzcy5wcm90b3R5cGUsIHByb3AsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgICB0aGlzW3RhcmdldFByb3BdW3Byb3BdID0gdmFsO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5UmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgaWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdENhbGwodGhpc1t0YXJnZXRQcm9wXSwgcHJvcCwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eU1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgaWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXS5hcHBseSh0aGlzW3RhcmdldFByb3BdLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgaWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5Q3Vyc29yUmVxdWVzdENhbGwodGhpc1t0YXJnZXRQcm9wXSwgcHJvcCwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBJbmRleChpbmRleCkge1xuICAgIHRoaXMuX2luZGV4ID0gaW5kZXg7XG4gIH1cblxuICBwcm94eVByb3BlcnRpZXMoSW5kZXgsICdfaW5kZXgnLCBbXG4gICAgJ25hbWUnLFxuICAgICdrZXlQYXRoJyxcbiAgICAnbXVsdGlFbnRyeScsXG4gICAgJ3VuaXF1ZSdcbiAgXSk7XG5cbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhJbmRleCwgJ19pbmRleCcsIElEQkluZGV4LCBbXG4gICAgJ2dldCcsXG4gICAgJ2dldEtleScsXG4gICAgJ2dldEFsbCcsXG4gICAgJ2dldEFsbEtleXMnLFxuICAgICdjb3VudCdcbiAgXSk7XG5cbiAgcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhJbmRleCwgJ19pbmRleCcsIElEQkluZGV4LCBbXG4gICAgJ29wZW5DdXJzb3InLFxuICAgICdvcGVuS2V5Q3Vyc29yJ1xuICBdKTtcblxuICBmdW5jdGlvbiBDdXJzb3IoY3Vyc29yLCByZXF1ZXN0KSB7XG4gICAgdGhpcy5fY3Vyc29yID0gY3Vyc29yO1xuICAgIHRoaXMuX3JlcXVlc3QgPSByZXF1ZXN0O1xuICB9XG5cbiAgcHJveHlQcm9wZXJ0aWVzKEN1cnNvciwgJ19jdXJzb3InLCBbXG4gICAgJ2RpcmVjdGlvbicsXG4gICAgJ2tleScsXG4gICAgJ3ByaW1hcnlLZXknLFxuICAgICd2YWx1ZSdcbiAgXSk7XG5cbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhDdXJzb3IsICdfY3Vyc29yJywgSURCQ3Vyc29yLCBbXG4gICAgJ3VwZGF0ZScsXG4gICAgJ2RlbGV0ZSdcbiAgXSk7XG5cbiAgLy8gcHJveHkgJ25leHQnIG1ldGhvZHNcbiAgWydhZHZhbmNlJywgJ2NvbnRpbnVlJywgJ2NvbnRpbnVlUHJpbWFyeUtleSddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kTmFtZSkge1xuICAgIGlmICghKG1ldGhvZE5hbWUgaW4gSURCQ3Vyc29yLnByb3RvdHlwZSkpIHJldHVybjtcbiAgICBDdXJzb3IucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgY3Vyc29yID0gdGhpcztcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIGN1cnNvci5fY3Vyc29yW21ldGhvZE5hbWVdLmFwcGx5KGN1cnNvci5fY3Vyc29yLCBhcmdzKTtcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3QoY3Vyc29yLl9yZXF1ZXN0KS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgaWYgKCF2YWx1ZSkgcmV0dXJuO1xuICAgICAgICAgIHJldHVybiBuZXcgQ3Vyc29yKHZhbHVlLCBjdXJzb3IuX3JlcXVlc3QpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIE9iamVjdFN0b3JlKHN0b3JlKSB7XG4gICAgdGhpcy5fc3RvcmUgPSBzdG9yZTtcbiAgfVxuXG4gIE9iamVjdFN0b3JlLnByb3RvdHlwZS5jcmVhdGVJbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgSW5kZXgodGhpcy5fc3RvcmUuY3JlYXRlSW5kZXguYXBwbHkodGhpcy5fc3RvcmUsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIE9iamVjdFN0b3JlLnByb3RvdHlwZS5pbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgSW5kZXgodGhpcy5fc3RvcmUuaW5kZXguYXBwbHkodGhpcy5fc3RvcmUsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIHByb3h5UHJvcGVydGllcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIFtcbiAgICAnbmFtZScsXG4gICAgJ2tleVBhdGgnLFxuICAgICdpbmRleE5hbWVzJyxcbiAgICAnYXV0b0luY3JlbWVudCdcbiAgXSk7XG5cbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG4gICAgJ3B1dCcsXG4gICAgJ2FkZCcsXG4gICAgJ2RlbGV0ZScsXG4gICAgJ2NsZWFyJyxcbiAgICAnZ2V0JyxcbiAgICAnZ2V0QWxsJyxcbiAgICAnZ2V0S2V5JyxcbiAgICAnZ2V0QWxsS2V5cycsXG4gICAgJ2NvdW50J1xuICBdKTtcblxuICBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcbiAgICAnb3BlbkN1cnNvcicsXG4gICAgJ29wZW5LZXlDdXJzb3InXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG4gICAgJ2RlbGV0ZUluZGV4J1xuICBdKTtcblxuICBmdW5jdGlvbiBUcmFuc2FjdGlvbihpZGJUcmFuc2FjdGlvbikge1xuICAgIHRoaXMuX3R4ID0gaWRiVHJhbnNhY3Rpb247XG4gICAgdGhpcy5jb21wbGV0ZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgaWRiVHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9O1xuICAgICAgaWRiVHJhbnNhY3Rpb24ub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QoaWRiVHJhbnNhY3Rpb24uZXJyb3IpO1xuICAgICAgfTtcbiAgICAgIGlkYlRyYW5zYWN0aW9uLm9uYWJvcnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KGlkYlRyYW5zYWN0aW9uLmVycm9yKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBUcmFuc2FjdGlvbi5wcm90b3R5cGUub2JqZWN0U3RvcmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IE9iamVjdFN0b3JlKHRoaXMuX3R4Lm9iamVjdFN0b3JlLmFwcGx5KHRoaXMuX3R4LCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoVHJhbnNhY3Rpb24sICdfdHgnLCBbXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnLFxuICAgICdtb2RlJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoVHJhbnNhY3Rpb24sICdfdHgnLCBJREJUcmFuc2FjdGlvbiwgW1xuICAgICdhYm9ydCdcbiAgXSk7XG5cbiAgZnVuY3Rpb24gVXBncmFkZURCKGRiLCBvbGRWZXJzaW9uLCB0cmFuc2FjdGlvbikge1xuICAgIHRoaXMuX2RiID0gZGI7XG4gICAgdGhpcy5vbGRWZXJzaW9uID0gb2xkVmVyc2lvbjtcbiAgICB0aGlzLnRyYW5zYWN0aW9uID0gbmV3IFRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKTtcbiAgfVxuXG4gIFVwZ3JhZGVEQi5wcm90b3R5cGUuY3JlYXRlT2JqZWN0U3RvcmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IE9iamVjdFN0b3JlKHRoaXMuX2RiLmNyZWF0ZU9iamVjdFN0b3JlLmFwcGx5KHRoaXMuX2RiLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoVXBncmFkZURCLCAnX2RiJywgW1xuICAgICduYW1lJyxcbiAgICAndmVyc2lvbicsXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhVcGdyYWRlREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xuICAgICdkZWxldGVPYmplY3RTdG9yZScsXG4gICAgJ2Nsb3NlJ1xuICBdKTtcblxuICBmdW5jdGlvbiBEQihkYikge1xuICAgIHRoaXMuX2RiID0gZGI7XG4gIH1cblxuICBEQi5wcm90b3R5cGUudHJhbnNhY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IFRyYW5zYWN0aW9uKHRoaXMuX2RiLnRyYW5zYWN0aW9uLmFwcGx5KHRoaXMuX2RiLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoREIsICdfZGInLCBbXG4gICAgJ25hbWUnLFxuICAgICd2ZXJzaW9uJyxcbiAgICAnb2JqZWN0U3RvcmVOYW1lcydcbiAgXSk7XG5cbiAgcHJveHlNZXRob2RzKERCLCAnX2RiJywgSURCRGF0YWJhc2UsIFtcbiAgICAnY2xvc2UnXG4gIF0pO1xuXG4gIC8vIEFkZCBjdXJzb3IgaXRlcmF0b3JzXG4gIC8vIFRPRE86IHJlbW92ZSB0aGlzIG9uY2UgYnJvd3NlcnMgZG8gdGhlIHJpZ2h0IHRoaW5nIHdpdGggcHJvbWlzZXNcbiAgWydvcGVuQ3Vyc29yJywgJ29wZW5LZXlDdXJzb3InXS5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmNOYW1lKSB7XG4gICAgW09iamVjdFN0b3JlLCBJbmRleF0uZm9yRWFjaChmdW5jdGlvbihDb25zdHJ1Y3Rvcikge1xuICAgICAgQ29uc3RydWN0b3IucHJvdG90eXBlW2Z1bmNOYW1lLnJlcGxhY2UoJ29wZW4nLCAnaXRlcmF0ZScpXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYXJncyA9IHRvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gYXJnc1thcmdzLmxlbmd0aCAtIDFdO1xuICAgICAgICB2YXIgbmF0aXZlT2JqZWN0ID0gdGhpcy5fc3RvcmUgfHwgdGhpcy5faW5kZXg7XG4gICAgICAgIHZhciByZXF1ZXN0ID0gbmF0aXZlT2JqZWN0W2Z1bmNOYW1lXS5hcHBseShuYXRpdmVPYmplY3QsIGFyZ3Muc2xpY2UoMCwgLTEpKTtcbiAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBjYWxsYmFjayhyZXF1ZXN0LnJlc3VsdCk7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgIH0pO1xuICB9KTtcblxuICAvLyBwb2x5ZmlsbCBnZXRBbGxcbiAgW0luZGV4LCBPYmplY3RTdG9yZV0uZm9yRWFjaChmdW5jdGlvbihDb25zdHJ1Y3Rvcikge1xuICAgIGlmIChDb25zdHJ1Y3Rvci5wcm90b3R5cGUuZ2V0QWxsKSByZXR1cm47XG4gICAgQ29uc3RydWN0b3IucHJvdG90eXBlLmdldEFsbCA9IGZ1bmN0aW9uKHF1ZXJ5LCBjb3VudCkge1xuICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgICAgIHZhciBpdGVtcyA9IFtdO1xuXG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICBpbnN0YW5jZS5pdGVyYXRlQ3Vyc29yKHF1ZXJ5LCBmdW5jdGlvbihjdXJzb3IpIHtcbiAgICAgICAgICBpZiAoIWN1cnNvcikge1xuICAgICAgICAgICAgcmVzb2x2ZShpdGVtcyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGl0ZW1zLnB1c2goY3Vyc29yLnZhbHVlKTtcblxuICAgICAgICAgIGlmIChjb3VudCAhPT0gdW5kZWZpbmVkICYmIGl0ZW1zLmxlbmd0aCA9PSBjb3VudCkge1xuICAgICAgICAgICAgcmVzb2x2ZShpdGVtcyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGN1cnNvci5jb250aW51ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xuXG4gIHZhciBleHAgPSB7XG4gICAgb3BlbjogZnVuY3Rpb24obmFtZSwgdmVyc2lvbiwgdXBncmFkZUNhbGxiYWNrKSB7XG4gICAgICB2YXIgcCA9IHByb21pc2lmeVJlcXVlc3RDYWxsKGluZGV4ZWREQiwgJ29wZW4nLCBbbmFtZSwgdmVyc2lvbl0pO1xuICAgICAgdmFyIHJlcXVlc3QgPSBwLnJlcXVlc3Q7XG5cbiAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgaWYgKHVwZ3JhZGVDYWxsYmFjaykge1xuICAgICAgICAgIHVwZ3JhZGVDYWxsYmFjayhuZXcgVXBncmFkZURCKHJlcXVlc3QucmVzdWx0LCBldmVudC5vbGRWZXJzaW9uLCByZXF1ZXN0LnRyYW5zYWN0aW9uKSk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHJldHVybiBwLnRoZW4oZnVuY3Rpb24oZGIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEQihkYik7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlbGV0ZTogZnVuY3Rpb24obmFtZSkge1xuICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3RDYWxsKGluZGV4ZWREQiwgJ2RlbGV0ZURhdGFiYXNlJywgW25hbWVdKTtcbiAgICB9XG4gIH07XG5cbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBleHA7XG4gICAgbW9kdWxlLmV4cG9ydHMuZGVmYXVsdCA9IG1vZHVsZS5leHBvcnRzO1xuICB9XG4gIGVsc2Uge1xuICAgIHNlbGYuaWRiID0gZXhwO1xuICB9XG59KCkpO1xuIiwiY29uc3QgaW1hZ2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmxhenknKTtcbmNvbnN0IGNvbmZpZyA9IHtcbiAgcm9vdE1hcmdpbjogJzUwcHggMHB4JyxcbiAgdGhyZXNob2xkOiAwLjAxXG59O1xuXG5sZXQgb2JzZXJ2ZXIgPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIob25JbnRlcnNlY3Rpb24sIGNvbmZpZyk7XG4gIGltYWdlcy5mb3JFYWNoKGltYWdlID0+IHtcbiAgICBvYnNlcnZlci5vYnNlcnZlKGltYWdlKTtcbiAgfSk7XG5cbiAgZnVuY3Rpb24gb25JbnRlcnNlY3Rpb24oZW50cmllcykge1xuICAgIGVudHJpZXMuZm9yRWFjaChlbnRyeSA9PiB7XG4gICAgICBpZiAoZW50cnkuaW50ZXJzZWN0aW9uUmF0aW8gPiAwKSB7XG4gIFxuICAgICAgICBvYnNlcnZlci51bm9ic2VydmUoZW50cnkudGFyZ2V0KTtcbiAgICAgICAgcHJlbG9hZEltYWdlKGVudHJ5LnRhcmdldCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0iLCJsZXQgcmVzdGF1cmFudHMsXHJcbiAgbmVpZ2hib3Job29kcyxcclxuICBjdWlzaW5lc1xyXG52YXIgbWFwXHJcbnZhciBtYXJrZXJzID0gW11cclxuXHJcbi8qKlxyXG4gKiBGZXRjaCBuZWlnaGJvcmhvb2RzIGFuZCBjdWlzaW5lcyBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cclxuICovXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoZXZlbnQpID0+IHtcclxuICBmZXRjaE5laWdoYm9yaG9vZHMoKTtcclxuICBmZXRjaEN1aXNpbmVzKCk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIGFuZCBzZXQgdGhlaXIgSFRNTC5cclxuICovXHJcbmZldGNoTmVpZ2hib3Job29kcyA9ICgpID0+IHtcclxuICBEQkhlbHBlci5mZXRjaE5laWdoYm9yaG9vZHMoKGVycm9yLCBuZWlnaGJvcmhvb2RzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2VsZi5uZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcztcclxuICAgICAgZmlsbE5laWdoYm9yaG9vZHNIVE1MKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXQgbmVpZ2hib3Job29kcyBIVE1MLlxyXG4gKi9cclxuZmlsbE5laWdoYm9yaG9vZHNIVE1MID0gKG5laWdoYm9yaG9vZHMgPSBzZWxmLm5laWdoYm9yaG9vZHMpID0+IHtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcclxuICBuZWlnaGJvcmhvb2RzLmZvckVhY2gobmVpZ2hib3Job29kID0+IHtcclxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xyXG4gICAgb3B0aW9uLmlubmVySFRNTCA9IG5laWdoYm9yaG9vZDtcclxuICAgIG9wdGlvbi52YWx1ZSA9IG5laWdoYm9yaG9vZDtcclxuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBjdWlzaW5lcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5mZXRjaEN1aXNpbmVzID0gKCkgPT4ge1xyXG4gIERCSGVscGVyLmZldGNoQ3Vpc2luZXMoKGVycm9yLCBjdWlzaW5lcykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxmLmN1aXNpbmVzID0gY3Vpc2luZXM7XHJcbiAgICAgIGZpbGxDdWlzaW5lc0hUTUwoKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCBjdWlzaW5lcyBIVE1MLlxyXG4gKi9cclxuZmlsbEN1aXNpbmVzSFRNTCA9IChjdWlzaW5lcyA9IHNlbGYuY3Vpc2luZXMpID0+IHtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XHJcblxyXG4gIGN1aXNpbmVzLmZvckVhY2goY3Vpc2luZSA9PiB7XHJcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgIG9wdGlvbi5pbm5lckhUTUwgPSBjdWlzaW5lO1xyXG4gICAgb3B0aW9uLnZhbHVlID0gY3Vpc2luZTtcclxuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgR29vZ2xlIG1hcCwgY2FsbGVkIGZyb20gSFRNTC5cclxuICovXHJcbndpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xyXG4gIGxldCBsb2MgPSB7XHJcbiAgICBsYXQ6IDQwLjcyMjIxNixcclxuICAgIGxuZzogLTczLjk4NzUwMVxyXG4gIH07XHJcbiAgc2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xyXG4gICAgem9vbTogMTIsXHJcbiAgICBjZW50ZXI6IGxvYyxcclxuICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxyXG4gIH0pO1xyXG4gIHVwZGF0ZVJlc3RhdXJhbnRzKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgcGFnZSBhbmQgbWFwIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzLlxyXG4gKi9cclxudXBkYXRlUmVzdGF1cmFudHMgPSAoKSA9PiB7XHJcbiAgY29uc3QgY1NlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcclxuICBjb25zdCBuU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0Jyk7XHJcblxyXG4gIGNvbnN0IGNJbmRleCA9IGNTZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuICBjb25zdCBuSW5kZXggPSBuU2VsZWN0LnNlbGVjdGVkSW5kZXg7XHJcblxyXG4gIGNvbnN0IGN1aXNpbmUgPSBjU2VsZWN0W2NJbmRleF0udmFsdWU7XHJcbiAgY29uc3QgbmVpZ2hib3Job29kID0gblNlbGVjdFtuSW5kZXhdLnZhbHVlO1xyXG5cclxuICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kLCAoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlc2V0UmVzdGF1cmFudHMocmVzdGF1cmFudHMpO1xyXG4gICAgICBmaWxsUmVzdGF1cmFudHNIVE1MKCk7XHJcbiAgICB9XHJcbiAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIENsZWFyIGN1cnJlbnQgcmVzdGF1cmFudHMsIHRoZWlyIEhUTUwgYW5kIHJlbW92ZSB0aGVpciBtYXAgbWFya2Vycy5cclxuICovXHJcbnJlc2V0UmVzdGF1cmFudHMgPSAocmVzdGF1cmFudHMpID0+IHtcclxuICAvLyBSZW1vdmUgYWxsIHJlc3RhdXJhbnRzXHJcbiAgc2VsZi5yZXN0YXVyYW50cyA9IFtdO1xyXG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnRzLWxpc3QnKTtcclxuICB1bC5pbm5lckhUTUwgPSAnJztcclxuXHJcbiAgLy8gUmVtb3ZlIGFsbCBtYXAgbWFya2Vyc1xyXG4gIHNlbGYubWFya2Vycy5mb3JFYWNoKG0gPT4gbS5zZXRNYXAobnVsbCkpO1xyXG4gIHNlbGYubWFya2VycyA9IFtdO1xyXG4gIHNlbGYucmVzdGF1cmFudHMgPSByZXN0YXVyYW50cztcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBhbGwgcmVzdGF1cmFudHMgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5maWxsUmVzdGF1cmFudHNIVE1MID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnRzLWxpc3QnKTtcclxuICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xyXG4gICAgdWwuYXBwZW5kKGNyZWF0ZVJlc3RhdXJhbnRIVE1MKHJlc3RhdXJhbnQpKTtcclxuICB9KTtcclxuICBhZGRNYXJrZXJzVG9NYXAoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwuXHJcbiAqL1xyXG5jcmVhdGVSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50KSA9PiB7XHJcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gIGNvbnN0IHNtYWxsID0gJ3NtYWxsJywgbWVkaXVtID0gJ21lZGl1bScsIGJpZyA9ICdiaWcnO1xyXG4gIGxldCBzaXplID0gc21hbGw7XHJcbiAgLy9jb25zdCB3c21hbGwgPSAnMzUwdycsIHdtZWRpdW0gPSAnNTUwdycsIGJpZyA9ICc4MDB3JztcclxuXHJcbiAgaWYod2luZG93Lm1hdGNoTWVkaWEoJ3NjcmVlbiBhbmQgKG1pbi13aWR0aDogMTAwMHB4KScpKVxyXG4gICAgc2l6ZSA9IG1lZGl1bTtcclxuICBlbHNlIGlmICh3aW5kb3cubWF0Y2hNZWRpYSgnc2NyZWVuIGFuZCAobWluLXdpZHRoOiA2MDBweCknKSlcclxuICAgIHNpemUgPSBzbWFsbDtcclxuXHJcbiAgLy9jb25zdCBwaWN0dXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncGljdHVyZScpO1xyXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nIGxhenknO1xyXG4gIC8vaW1hZ2Uuc3JjID0gJyc7XHJcbiAgaW1hZ2Uuc2V0QXR0cmlidXRlKCdkYXRhLXNyYycsIERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzaXplKSk7XHJcbiAgaW1hZ2UuYWx0ID0gcmVzdGF1cmFudC5uYW1lICsgJyByZXN0dXJhbnQgcGljdHVyZSc7XHJcbiAgaWYocmVzdGF1cmFudC5pZCA9PSAxMCl7XHJcbiAgICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ29ubG9hZCcsICdsYXp5TG9hZCgpJyk7XHJcbiAgfVxyXG4gIC8qaW1hZ2Uuc3Jjc2V0ID0gYCR7REJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIHNtYWxsKX0gJHt3c21hbGx9LFxyXG4gICAgICAgICAgICAgICAgICAgICR7REJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIG1lZGl1bSl9ICR7d21lZGl1bX0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICR7REJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIGJpZyl9ICR7d2JpZ31gOyovXHJcbiAgLypjb25zdCBzb3VyY2UxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XHJcbiAgc291cmNlMS5tZWRpYSA9IFwic2NyZWVuIGFuZCAobWluLXdpZHRoOiA2MDBweClcIjtcclxuICBzb3VyY2UxLnNyY3NldCA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBtZWRpdW0pO1xyXG4gIGNvbnN0IHNvdXJjZTIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcclxuICBzb3VyY2UyLm1lZGlhID0gXCJzY3JlZW4gYW5kIChtaW4td2lkdGg6IDEwMDBweClcIjtcclxuICBzb3VyY2UyLnNyY3NldCA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBiaWcpOyovXHJcbiAgXHJcbiAgLypwaWN0dXJlLmFwcGVuZENoaWxkKGltYWdlKTtcclxuICBwaWN0dXJlLmFwcGVuZENoaWxkKHNvdXJjZTEpO1xyXG4gIHBpY3R1cmUuYXBwZW5kQ2hpbGQoc291cmNlMik7Ki8gICAgICAgICAgICAgICAgICAgICAgXHJcbiAgbGkuYXBwZW5kKGltYWdlKTtcclxuXHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcbiAgbmFtZS50YWJJbmRleCA9IDA7XHJcbiAgbGkuYXBwZW5kKG5hbWUpO1xyXG5cclxuICBjb25zdCBuZWlnaGJvcmhvb2QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgbmVpZ2hib3Job29kLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmVpZ2hib3Job29kO1xyXG4gIG5laWdoYm9yaG9vZC50YWJJbmRleCA9IDA7XHJcbiAgbGkuYXBwZW5kKG5laWdoYm9yaG9vZCk7XHJcblxyXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XHJcbiAgYWRkcmVzcy50YWJJbmRleCA9IDA7XHJcbiAgbGkuYXBwZW5kKGFkZHJlc3MpO1xyXG5cclxuICBjb25zdCBtb3JlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gIG1vcmUuaW5uZXJIVE1MID0gJ1ZpZXcgRGV0YWlscyc7XHJcbiAgbW9yZS5ocmVmID0gREJIZWxwZXIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuICBsaS5hcHBlbmQobW9yZSlcclxuXHJcbiAgcmV0dXJuIGxpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBZGQgbWFya2VycyBmb3IgY3VycmVudCByZXN0YXVyYW50cyB0byB0aGUgbWFwLlxyXG4gKi9cclxuYWRkTWFya2Vyc1RvTWFwID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XHJcbiAgICAvLyBBZGQgbWFya2VyIHRvIHRoZSBtYXBcclxuICAgIGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2VsZi5tYXApO1xyXG4gICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gbWFya2VyLnVybFxyXG4gICAgfSk7XHJcbiAgICBzZWxmLm1hcmtlcnMucHVzaChtYXJrZXIpO1xyXG4gIH0pO1xyXG59XHJcbiIsImxldCByZXN0YXVyYW50O1xudmFyIG1hcDtcblxuLyoqXG4gKiBJbml0aWFsaXplIEdvb2dsZSBtYXAsIGNhbGxlZCBmcm9tIEhUTUwuXG4gKi9cbndpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xuICBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xuICAgICAgICB6b29tOiAxNixcbiAgICAgICAgY2VudGVyOiByZXN0YXVyYW50LmxhdGxuZyxcbiAgICAgICAgc2Nyb2xsd2hlZWw6IGZhbHNlXG4gICAgICB9KTtcbiAgICAgIGZpbGxCcmVhZGNydW1iKCk7XG4gICAgICBEQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHNlbGYucmVzdGF1cmFudCwgc2VsZi5tYXApO1xuICAgIH1cbiAgfSk7XG59XG5cbi8qKlxuICogR2V0IGN1cnJlbnQgcmVzdGF1cmFudCBmcm9tIHBhZ2UgVVJMLlxuICovXG5mZXRjaFJlc3RhdXJhbnRGcm9tVVJMID0gKGNhbGxiYWNrKSA9PiB7XG4gIGlmIChzZWxmLnJlc3RhdXJhbnQpIHsgLy8gcmVzdGF1cmFudCBhbHJlYWR5IGZldGNoZWQhXG4gICAgY2FsbGJhY2sobnVsbCwgc2VsZi5yZXN0YXVyYW50KVxuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBpZCA9IGdldFBhcmFtZXRlckJ5TmFtZSgnaWQnKTtcbiAgaWYgKCFpZCkgeyAvLyBubyBpZCBmb3VuZCBpbiBVUkxcbiAgICBlcnJvciA9ICdObyByZXN0YXVyYW50IGlkIGluIFVSTCdcbiAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XG4gIH0gZWxzZSB7XG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XG4gICAgICBzZWxmLnJlc3RhdXJhbnQgPSByZXN0YXVyYW50O1xuICAgICAgaWYgKCFyZXN0YXVyYW50KSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBmaWxsUmVzdGF1cmFudEhUTUwoKTtcbiAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpXG4gICAgfSk7XG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2VcbiAqL1xuZmlsbFJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LW5hbWUnKTtcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XG4gIG5hbWUudGFiSW5kZXggPSAwO1xuXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1hZGRyZXNzJyk7XG4gIGFkZHJlc3MuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5hZGRyZXNzO1xuICBhZGRyZXNzLnRhYkluZGV4ID0gMDtcblxuICBjb25zdCBzbWFsbCA9ICdzbWFsbCcsIG1lZGl1bSA9ICdtZWRpdW0nLCBiaWcgPSAnYmlnJztcbiAgbGV0IHNpemUgPSBzbWFsbDtcbiAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1pbWcnKTtcblxuICBpZih3aW5kb3cubWF0Y2hNZWRpYSgnc2NyZWVuIGFuZCAobWluLXdpZHRoOiAxMDAwcHgpJykpXG4gICAgc2l6ZSA9IG1lZGl1bTtcbiAgZWxzZSBpZiAod2luZG93Lm1hdGNoTWVkaWEoJ3NjcmVlbiBhbmQgKG1pbi13aWR0aDogNjAwcHgpJykpXG4gICAgc2l6ZSA9IHNtYWxsO1xuICAgIFxuICBpbWFnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcgbGF6eSdcbiAgLy9pbWFnZS5zcmMgPSAnJztcbiAgaW1hZ2Uuc2V0QXR0cmlidXRlKCdkYXRhLXNyYycsIERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzaXplKSk7XG4gIGltYWdlLmFsdCA9IHJlc3RhdXJhbnQubmFtZSArICcgcmVzdHVyYW50IHBpY3R1cmUnO1xuXG4gIGNvbnN0IGN1aXNpbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1jdWlzaW5lJyk7XG4gIGN1aXNpbmUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5jdWlzaW5lX3R5cGU7XG4gIGN1aXNpbmUudGFiSW5kZXggPSAwO1xuXG4gIC8vIGZpbGwgb3BlcmF0aW5nIGhvdXJzXG4gIGlmIChyZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vycykge1xuICAgIGZpbGxSZXN0YXVyYW50SG91cnNIVE1MKCk7XG4gIH1cbiAgLy8gZmlsbCByZXZpZXdzXG4gIGZpbGxSZXZpZXdzSFRNTCgpO1xufVxuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IG9wZXJhdGluZyBob3VycyBIVE1MIHRhYmxlIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmZpbGxSZXN0YXVyYW50SG91cnNIVE1MID0gKG9wZXJhdGluZ0hvdXJzID0gc2VsZi5yZXN0YXVyYW50Lm9wZXJhdGluZ19ob3VycykgPT4ge1xuICBjb25zdCBob3VycyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWhvdXJzJyk7XG4gIGZvciAobGV0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xuICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XG4gICAgcm93LnRhYkluZGV4ID0gMDsgXG5cbiAgICBjb25zdCBkYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuICAgIGRheS5pbm5lckhUTUwgPSBrZXk7XG4gICAgcm93LmFwcGVuZENoaWxkKGRheSk7XG5cbiAgICBjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcbiAgICB0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV07XG4gICAgcm93LmFwcGVuZENoaWxkKHRpbWUpO1xuXG4gICAgaG91cnMuYXBwZW5kQ2hpbGQocm93KTtcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZSBhbGwgcmV2aWV3cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cbiAqL1xuZmlsbFJldmlld3NIVE1MID0gKHJldmlld3MgPSBzZWxmLnJlc3RhdXJhbnQucmV2aWV3cykgPT4ge1xuICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1jb250YWluZXInKTtcbiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xuICB0aXRsZS5pbm5lckhUTUwgPSAnUmV2aWV3cyc7XG4gIHRpdGxlLnRhYkluZGV4ID0gMDtcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRpdGxlKTtcblxuICBpZiAoIXJldmlld3MpIHtcbiAgICBjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgbm9SZXZpZXdzLmlubmVySFRNTCA9ICdObyByZXZpZXdzIHlldCEnO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChub1Jldmlld3MpO1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKTtcbiAgcmV2aWV3cy5mb3JFYWNoKHJldmlldyA9PiB7XG4gICAgdWwuYXBwZW5kQ2hpbGQoY3JlYXRlUmV2aWV3SFRNTChyZXZpZXcpKTtcbiAgfSk7XG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh1bCk7XG59XG5cbi8qKlxuICogQ3JlYXRlIHJldmlldyBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmNyZWF0ZVJldmlld0hUTUwgPSAocmV2aWV3KSA9PiB7XG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgbmFtZS5pbm5lckhUTUwgPSByZXZpZXcubmFtZTtcbiAgbmFtZS50YWJJbmRleCA9IDA7XG4gIGxpLmFwcGVuZENoaWxkKG5hbWUpO1xuXG4gIGNvbnN0IGRhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGRhdGUuaW5uZXJIVE1MID0gcmV2aWV3LmRhdGU7XG4gIGRhdGUudGFiSW5kZXggPSAwO1xuICBsaS5hcHBlbmRDaGlsZChkYXRlKTtcblxuICBjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIHJhdGluZy5pbm5lckhUTUwgPSBgUmF0aW5nOiAke3Jldmlldy5yYXRpbmd9YDtcbiAgcmF0aW5nLnRhYkluZGV4ID0gMDtcbiAgbGkuYXBwZW5kQ2hpbGQocmF0aW5nKTtcblxuICBjb25zdCBjb21tZW50cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29tbWVudHMuaW5uZXJIVE1MID0gcmV2aWV3LmNvbW1lbnRzO1xuICBjb21tZW50cy50YWJJbmRleCA9IDA7XG4gIGxpLmFwcGVuZENoaWxkKGNvbW1lbnRzKTtcblxuICByZXR1cm4gbGk7XG59XG5cbi8qKlxuICogQWRkIHJlc3RhdXJhbnQgbmFtZSB0byB0aGUgYnJlYWRjcnVtYiBuYXZpZ2F0aW9uIG1lbnVcbiAqL1xuZmlsbEJyZWFkY3J1bWIgPSAocmVzdGF1cmFudD1zZWxmLnJlc3RhdXJhbnQpID0+IHtcbiAgY29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJyk7XG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgbGkuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xuICBicmVhZGNydW1iLmFwcGVuZENoaWxkKGxpKTtcbn1cblxuLyoqXG4gKiBHZXQgYSBwYXJhbWV0ZXIgYnkgbmFtZSBmcm9tIHBhZ2UgVVJMLlxuICovXG5nZXRQYXJhbWV0ZXJCeU5hbWUgPSAobmFtZSwgdXJsKSA9PiB7XG4gIGlmICghdXJsKVxuICAgIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICBuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXFxdXS9nLCAnXFxcXCQmJyk7XG4gIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgWz8mXSR7bmFtZX0oPShbXiYjXSopfCZ8I3wkKWApLFxuICAgIHJlc3VsdHMgPSByZWdleC5leGVjKHVybCk7XG4gIGlmICghcmVzdWx0cylcbiAgICByZXR1cm4gbnVsbDtcbiAgaWYgKCFyZXN1bHRzWzJdKVxuICAgIHJldHVybiAnJztcbiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcbn1cbiJdfQ==
